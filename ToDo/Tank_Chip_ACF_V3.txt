@name Tank Chip ACF V3
@inputs [Pod]:entity
@outputs Debug 

@inputs W S A D Reverse EngineRPM 
@outputs Throttle ClutchL ClutchR BrakeL BrakeR Gear EngineRPM LL LR TrackLock Speed
@persist Clutch TClutch Brake R Speed EngineRPM LSpeed LatchEngageSpeed BrakePower BrakeLeft BrakeRight 


@persist [Pos Turningf Turningb Force]:vector
@inputs AmmoSwitch 
@outputs AmmoType 
@persist Aon TrackPitch 
@persist SpeedOut 
@persist T1 
@trigger all





interval(20)
   

    
#Engine and Gearbox control
    
    MinRPM = 1000          #leave this alone except for high rpm engines; set it to like 1400-1500 for the big-ass diesel engines
    ClutchSmoother = 0.4   #increase this by a tenth (0.1 > 0.5 etc) if you need a smoother clutch
    LatchEngageSpeed = 10  #Max speed for weld latch steering control (shuts off after this speed)
    BrakePower = 8       #Stopping power. Braking is a variable of 0-100, however usually over 40 brakes get spazzy
    BrakeLeft = clamp((10  - Speed / 6),1,10)     #Left track stopping power
    BrakeRight = clamp((10  - Speed / 6),1,10)       #Right track stopping power


#Auto gearbox, use manual shifting with whatever to find good shift speeds. Make sure you set gear 1 of the gearbox to a negative ratio so it will act as reverse.
    Speed = entity():vel():length() / 17.6

    if(Speed<12){Gear = 1}
    if(Speed>13){Gear = 2}
    if(Speed>25){Gear = 3}
    if(Speed>35){Gear = 4}
    if(Speed>39){Gear = 5}

if(Reverse & ~Reverse) {R = !R}

if(R) {Gear = 6}

if(!A|!D)
{TrackLock = 0}
if(A|D)
{TrackLock = 0}

#Change the name of the ammo types in the hints if you're using diff. ammo

####### You shouldn't have to edit anything below this



if(clk()){
    

    if(W|A|D) {Throttle=100}
    else{Throttle=0}

    


#RPM & ClutchControl    
    #RPM Monitor
    if(EngineRPM>MinRPM){
        TClutch = clamp(!W,0,0.4)
    }else{
        TClutch = 0
    }
    

    #ClutchSmoother
    
    Clutch = clamp(TClutch,Clutch-ClutchSmoother,Clutch+ClutchSmoother)
    ClutchR = Clutch
    ClutchL = Clutch
    
if(A) {ClutchL=1}
if(D) {ClutchR=1}
#lower Brake if shit spacks out
Brake = BrakeL + BrakeR
if(S) {Brake = BrakePower}
else{Brake = 0}

if(A) {BrakeL = BrakeLeft} else{BrakeL = Brake}
if(D) {BrakeR = BrakeRight} else{BrakeR = Brake}

}
if(Speed < LatchEngageSpeed){
    if(A) {LL = 1} else{LL = 0}
    if(D) {LR = 1} else{LR = 0}
}
else{
    LL = 0
    LR = 0
}





if(AmmoSwitch & ~AmmoSwitch) {Aon = !Aon}
if(Aon) {SecondaryAmmo = 1} else{SecondaryAmmo = 0}
if(!Aon) {PrimaryAmmo = 1} else{PrimaryAmmo = 0}



#niggers nigger niggerpenispenispenis










